@page "{handler?}/{ismodal:bool}"
@model SERVERAPI.Pages.RanchAnimals.CreateEdit

@{
    Layout = Model.PageLayout;
}

<!-- Modal -->
<div class="modal" id="add-contact" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document" id="divSize">
        <div class="modal-content">

            @if (Model.IsModal)
            {
                @* This puts the header as the bar on the Modal *@
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h2 class="modal-title" id="myModalLabel">Animal Details - Razor page</h2>
                </div>
            }
            else
            {
                <div class="header-height"></div>

                <br />
                <br />
            }
            @*This determines the size within the Modal Window*@
            <div class="@Model.BodyClass" id="create-edit" role="dialog">
                @* Puts a border around the form when not in a modal window *@
                <div class="@Model.FormBoxClass">
                    @if (!Model.IsModal)
                    {
                        <div class="form-box-header clearfix">
                            <div class="form-box-heading">Add Animals - Razor page</div>
                        </div>
                    }
                    @*<form asp-page="CreateEdit" asp-page-handler="Create" asp-route-ismodal="@Model.IsModal"  data-ajax="true" data-ajax-method="POST" data-ajax-mode="REPLACE-WITH" data-ajax-update="#target">*@
                    <form asp-page="CreateEdit" asp-page-handler="Create" asp-route-ismodal="True" method="post" class="form-box-body">
                        @*<form method="post" class="form-box-body">*@
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <div class="form-box-fields">
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label for="ddlSubType">Cattle Type</label>
                                    <select class="form-control" asp-for="@Model.Data.CattleSubTypeId"
                                            asp-items="@Model.Data.CattleSubTypeOptions" id="ddlSubType"
                                            onchange="SetCattleSubTypeName(this.selectedOptions[0])">
                                        <option value=0>Select Cattle Type</option>
                                    </select>
                                    <input id="CattleSubTypeName" asp-for="@Model.Data.CattleSubTypeName" type="hidden" />
                                    @Html.ValidationMessageFor(model => model.Data.CattleSubTypeId)
                                </div>
                                <div class="form-group col-sm-6">
                                    <label for="averageAnimalNumber">Average Animal Number on Farm</label>
                                    <input class="form-control" asp-for="@Model.Data.AverageAnimalNumber"
                                           id="averageAnimalNumber" type="number" placeholder="@Model.Data.Placehldr"
                                           style="width: 100px" />
                                    @Html.ValidationMessageFor(model => model.Data.AverageAnimalNumber)
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label for="isManureCollected">Do you pile or collect manure from these animals?</label>
                                    <div role="radiogroup" aria-labelledby="labelisManureCollected">
                                        <label style="padding-right: 20px">
                                            <input asp-for="@Model.Data.IsManureCollected" type="radio" value="true"
                                                   id="rbIsManureCollectedYes" onchange="IsManureCollectedChanged(true)" /> Yes
                                        </label>
                                        <label>
                                            <input asp-for="@Model.Data.IsManureCollected" type="radio" value="false"
                                                   id="rbIsManureCollectedNo" onchange="IsManureCollectedChanged(false)" /> No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            @{
                                var displayDuration = "none";
                            }
                            @if (Model.Data.IsManureCollected)
                            {
                                displayDuration = "inline";
                            }
                            <div class="row" id="durationValue" style="display:@displayDuration">
                                <div class="form-group col-sm-6">
                                    <table class="m-0">
                                        <tr>
                                            <td><label for="txtDuration">Duration</label></td>
                                            <td>
                                                <input class="form-control" asp-for="@Model.Data.DurationDays"
                                                       id="txtDuration" type="number" style="width: 100px" />
                                                @Html.ValidationMessageFor(model => model.Data.DurationDays)
                                            </td>
                                            <td>Days</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn" type="button" data-dismiss="modal">Cancel</button>
                            <input class="btn btn-primary" type="submit" value="Save" data-save="razor-page-modal" />
                        </div>
                        @Html.HiddenFor(x => x.Data.ButtonPressed)
                        @Html.HiddenFor(x => x.Data.AnimalId)
                        @Html.HiddenFor(x => x.Data.AnimalName)
                        @*Carry forward the ModelState for Modal*@

                        <input name="IsValid" type="hidden" value="@ViewData.ModelState.IsValid.ToString()" />
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    //Show the Duration Field when IsManureCollected True
    function IsManureCollectedChanged(value) {
        if (value) {
            $('#durationValue').show();
        } else {
            $('#durationValue').hide();
        }
    }

    //Record the CattleSubTypeName when Dropdown is changed
    function SetCattleSubTypeName(selectObject) {
        var text = selectObject.text;
        $('#CattleSubTypeName').val(text);
    }
</script>
@section Scripts {}